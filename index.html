<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONYX: –í—ã–∑–æ–≤ –ø—Ä–∏–Ω—è—Ç</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: 'Arial', sans-serif; background-color: #f5f6fa; color: #2c3e50; margin: 0; padding: 0; font-size: 16px; line-height: 1.5; }
        .container { max-width: 600px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; background: linear-gradient(135deg, #2c3e50, #34495e); color: white; padding: 20px; border-radius: 10px 10px 0 0; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .header h1 { margin: 0; font-size: 28px; }
        .header p { margin: 5px 0 0; font-size: 18px; }
        .section { margin: 20px 0; padding: 20px; border-radius: 10px; background-color: #ffffff; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .task-level { cursor: pointer; padding: 15px; background-color: #ffffff; border-radius: 10px; margin: 10px 0; box-shadow: 0 2px 4px rgba(0,0,0,0.1); transition: transform 0.2s ease; }
        .task-level:hover { transform: translateY(-5px); }
        .task-level h2 { margin: 0 0 10px; font-size: 22px; color: #2ecc71; }
        .task { margin: 15px 0; padding: 10px; border-left: 4px solid #2ecc71; }
        .task p { margin: 0 0 10px; }
        .task input[type="file"] { margin-top: 5px; display: block; width: 100%; }
        .task button { background-color: #2ecc71; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; transition: background-color 0.3s ease; }
        .task button:hover { background-color: #27ae60; }
        .task button:disabled { background-color: #bdc3c7; cursor: not-allowed; }
        .balance h3 { font-size: 20px; margin: 0 0 10px; color: #2c3e50; }
        .referral { margin: 20px 0; padding: 15px; background-color: #e8f4f8; border-radius: 10px; }
        .referral h3 { font-size: 20px; margin: 0 0 10px; }
        .referral button { background-color: #3498db; color: white; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .referral button:hover { background-color: #2980b9; }
        .store { margin: 20px 0; padding: 15px; background-color: #f9f9f9; border-radius: 10px; }
        .store h3 { font-size: 20px; margin: 0 0 10px; }
        .store-item { margin: 10px 0; padding: 10px; border: 1px solid #ecf0f1; border-radius: 5px; }
        .store-item button { background-color: #e67e22; color: white; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .store-item button:hover { background-color: #d35400; }
        .store-item button:disabled { background-color: #bdc3c7; cursor: not-allowed; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ONYX: –í—ã–∑–æ–≤ –ø—Ä–∏–Ω—è—Ç</h1>
            <p>–í–∞—à–∏ –±–∞–ª–ª—ã: <span id="points">0</span></p>
        </div>

        <div class="section referral">
            <h3>–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</h3>
            <p>–ü—Ä–∏–≥–ª–∞—à–∞–π—Ç–µ –¥—Ä—É–∑–µ–π –∏ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ 300 –±–∞–ª–ª–æ–≤ –∑–∞ –∫–∞–∂–¥–æ–≥–æ (–º–∞–∫—Å–∏–º—É–º 10 –¥—Ä—É–∑–µ–π).</p>
            <p>–í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞: <span id="referralLink"></span></p>
            <button onclick="shareReferral()">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π</button>
            <p>–ü—Ä–∏–≥–ª–∞—à–µ–Ω–æ –¥—Ä—É–∑–µ–π: <span id="referralsCount">0</span></p>
        </div>

        <div class="section store">
            <h3>–ú–∞–≥–∞–∑–∏–Ω –ø—Ä–∏–∑–æ–≤</h3>
            <div class="store-item">
                <p>–ü–ª—ë–Ω–∫–∞, –∫–∞–±–µ–ª—å, —á–µ—Ö–æ–ª ‚Äî 500 –±–∞–ª–ª–æ–≤</p>
                <button onclick="buyPrize('–ü–ª—ë–Ω–∫–∞, –∫–∞–±–µ–ª—å, —á–µ—Ö–æ–ª', 500)">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="store-item">
                <p>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞ 2000 —Ä—É–±–ª–µ–π ‚Äî 2000 –±–∞–ª–ª–æ–≤</p>
                <button onclick="buyPrize('–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–∞ 2000 —Ä—É–±–ª–µ–π', 2000)">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="store-item">
                <p>–ó–∞—Ä—è–¥–∫–∞, –ø–∞—É—ç—Ä–±–∞–Ω–∫, –±—Ä–µ–ª–æ–∫ ONYX, Dyson –Ω–∞–±–æ—Ä ‚Äî 5000 –±–∞–ª–ª–æ–≤</p>
                <button onclick="buyPrize('–ó–∞—Ä—è–¥–∫–∞, –ø–∞—É—ç—Ä–±–∞–Ω–∫, –±—Ä–µ–ª–æ–∫ ONYX, Dyson –Ω–∞–±–æ—Ä', 5000)">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="store-item">
                <p>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç 5000 —Ä—É–±–ª–µ–π ‚Äî 8000 –±–∞–ª–ª–æ–≤</p>
                <button onclick="buyPrize('–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç 5000 —Ä—É–±–ª–µ–π', 8000)">–ö—É–ø–∏—Ç—å</button>
            </div>
            <div class="store-item">
                <p>Airpods 3 ‚Äî 10 000+ –±–∞–ª–ª–æ–≤</p>
                <button onclick="buyPrize('Airpods 3', 10000)">–ö—É–ø–∏—Ç—å</button>
            </div>
        </div>

        <div class="section task-level" id="level1" onclick="showLevel('level1')">
            <h2>üü¢ Level 1 ‚Äî –ù–æ–≤–∏—á–æ–∫</h2>
        </div>
        <div class="section task-level" id="level2" onclick="showLevel('level2')">
            <h2>üü° Level 2 ‚Äî –•–∞—Å—Ç–ª–µ—Ä</h2>
        </div>
        <div class="section task-level" id="level3" onclick="showLevel('level3')">
            <h2>üîµ Level 3 ‚Äî –†–µ–∑–∏–¥–µ–Ω—Ç ONYX</h2>
        </div>
        <div class="section task-level" id="level4" onclick="showLevel('level4')">
            <h2>üî¥ Level 4 ‚Äî –ë–µ–∑–±–∞—à–µ–Ω–Ω—ã–π</h2>
        </div>
        <div class="section task-level" id="srank" onclick="showLevel('srank')">
            <h2>üî¥ S-Rank ‚Äî –û—Å–æ–±–µ–Ω–Ω—ã–π</h2>
        </div>

        <div id="level1-tasks" class="section hidden">
            <h2>üü¢ Level 1 ‚Äî –ù–æ–≤–∏—á–æ–∫</h2>
            <div class="task"><input type="file" id="task1-1" accept="image/*,video/*"><button onclick="submitTask('task1-1', 50, '–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ Telegram/Instagram', isLocked())">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ Telegram –∏ Instagram ONYX ‚Äî 50 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task1-2" accept="image/*,video/*"><button onclick="submitTask('task1-2', 100, '–ü–æ–∫—É–ø–∫–∞', isLocked())">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –û—Ñ–æ—Ä–º–∏ –ø–æ–∫—É–ø–∫—É –Ω–∞ –ª—é–±—É—é —Å—É–º–º—É ‚Äî 100 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task1-3" accept="image/*,video/*"><button onclick="submitTask('task1-3', 100, '–û—Ç–∑—ã–≤', isLocked())">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –û—Å—Ç–∞–≤—å –æ—Ç–∑—ã–≤ –Ω–∞ 2–ì–ò–° –∏–ª–∏ –Ø–Ω–¥–µ–∫—Å ‚Äî 100 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task1-4" accept="image/*,video/*"><button onclick="submitTask('task1-4', 150, '–°—Ç–æ—Ä–∏—Å', isLocked())">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –û—Ç–º–µ—Ç—å ONYX –≤ —Å—Ç–æ—Ä–∏—Å whatsapp/Instagram/telegram –Ω–∞ –≤—ã–±–æ—Ä, —Å –ø–æ–∫—É–ø–∫–æ–π ‚Äî 150 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task1-5" accept="image/*,video/*"><button onclick="submitTask('task1-5', 70, '–í–∏–∫—Ç–æ—Ä–∏–Ω–∞', isLocked())">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –£—á–∞—Å—Ç–≤—É–π –≤ –≤–∏–∫—Ç–æ—Ä–∏–Ω–µ –≤ Telegram ‚Äî 70 –±–∞–ª–ª–æ–≤</div>
            <button onclick="backToMain()">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="level2-tasks" class="section hidden">
            <h2>üü° Level 2 ‚Äî –•–∞—Å—Ç–ª–µ—Ä</h2>
            <div class="task"><input type="file" id="task2-1" accept="image/*,video/*"><button onclick="submitTask('task2-1', 300, '–†–µ—Ñ–µ—Ä–∞–ª', isLocked('level1'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ü—Ä–∏–≤–µ–¥–∏ –¥—Ä—É–≥–∞ –ø–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π —Å—Å—ã–ª–∫–µ 10 –º–∞–∫—Å–∏–º—É–º ‚Äî 300 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task2-2" accept="image/*,video/*"><button onclick="submitTask('task2-2', 300, '–¢—Ä–µ–π–¥-–∏–Ω', isLocked('level1'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ü—Ä–∏–Ω–µ—Å–∏ —Å—Ç–∞—Ä—ã–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω –Ω–∞ —Ç—Ä–µ–π–¥-–∏–Ω ‚Äî 300 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task2-3" accept="image/*,video/*"><button onclick="submitTask('task2-3', 400, '–û–±–∑–æ—Ä', isLocked('level1'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –°–Ω–∏–º–∏ –∫–æ—Ä–æ—Ç–∫–∏–π –æ–±–∑–æ—Ä –Ω–∞ —Ç–µ—Ö–Ω–∏–∫—É –∏–∑ ONYX ‚Äî 400 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task2-4" accept="image/*,video/*"><button onclick="submitTask('task2-4', 500, '–ú–∏–Ω–∏-–æ–±–∑–æ—Ä', isLocked('level1'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –°–¥–µ–ª–∞–π –º–∏–Ω–∏-–æ–±–∑–æ—Ä –∏–∑ –º–∞–≥–∞–∑–∏–Ω–∞ reels/tiktok/–ø–æ—Å—Ç –∏–Ω—Å—Ç —Ç—Ä—ç–¥—Å ‚Äî 500 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task2-5" accept="image/*,video/*"><button onclick="submitTask('task2-5', 500, '–°—Ç–∞—Ç—å—è', isLocked('level1'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ù–∞–ø–∏—à–∏ —Å—Ç–∞—Ç—å—é/–æ—Ç–∑—ã–≤ –≤ –î–∑–µ–Ω/–∏–Ω—Å—Ç/–≤–∫ –ø–æ—Å—Ç –æ —Å–≤–æ—ë–º –æ–ø—ã—Ç–µ ‚Äî 500 –±–∞–ª–ª–æ–≤</div>
            <button onclick="backToMain()">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="level3-tasks" class="section hidden">
            <h2>üîµ Level 3 ‚Äî –†–µ–∑–∏–¥–µ–Ω—Ç ONYX</h2>
            <div class="task"><input type="file" id="task3-1" accept="image/*,video/*"><button onclick="submitTask('task3-1', 600, 'Reels', isLocked('level2'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> Reels —Å —Å—é–∂–µ—Ç–æ–º –ø—Ä–æ –≤—ã–±–æ—Ä —Ç–µ—Ö–Ω–∏–∫–∏ ‚Äî 600 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task3-2" accept="image/*,video/*"><button onclick="submitTask('task3-2', 800, '5 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤', isLocked('level2'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> 5 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∫–æ—Ç–æ—Ä—ã–µ –¥–æ—à–ª–∏ –¥–æ 3 —É—Ä–æ–≤–Ω—è ‚Äî 800 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task3-3" accept="image/*,video/*"><button onclick="submitTask('task3-3', 1000, '–í–∏—Ä—É—Å–Ω—ã–π TikTok/Reels', isLocked('level2'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –í–∏—Ä—É—Å–Ω—ã–π TikTok/Reels (10–∫+ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤) ‚Äî 1000 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task3-4" accept="image/*,video/*"><button onclick="submitTask('task3-4', 1200, '–£–ª–∏—á–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞', isLocked('level2'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –£–ø–æ–º–∏–Ω–∞–Ω–∏–µ ONYX –≤ —É–ª–∏—á–Ω–æ–π –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–π —Ä–µ–∫–ª–∞–º–µ —Å–Ω—è—Ç—å –≤–∏–¥–µ–æ –∏ –≤—ã–ª–æ–∂–∏—Ç—å reels/tiktok ‚Äî 1200 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task3-5" accept="image/*,video/*"><button onclick="submitTask('task3-5', 1500, '–ü—É–±–ª–∏—á–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞', isLocked('level2'))">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –°–¥–µ–ª–∞–π –ø—É–±–ª–∏—á–Ω—É—é, –∫—Ä–µ–∞—Ç–∏–≤–Ω—É—é —Ä–µ–∫–ª–∞–º—É ONYX –≤ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–º –º–µ—Å—Ç–µ ‚Äî 1500 –±–∞–ª–ª–æ–≤</div>
            <button onclick="backToMain()">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="level4-tasks" class="section hidden">
            <h2>üî¥ Level 4 ‚Äî –ë–µ–∑–±–∞—à–µ–Ω–Ω—ã–π</h2>
            <div class="task"><input type="file" id="task4-1" accept="image/*,video/*"><button onclick="submitTask('task4-1', 0, '–ü—Ä—ã–∂–æ–∫ —Å –ø–∞—Ä–∞—à—é—Ç–æ–º', 'Apple Watch –∏–ª–∏ Airpods')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ü—Ä—ã–∂–æ–∫ —Å –ø–∞—Ä–∞—à—é—Ç–æ–º —Å –º–µ—Ä—á–æ–º ONYX –∏ Apple Watch –∏ –æ—Ç–∫—Ä–æ–π –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø—Ä—ã–∂–∫–∞ (—É—Ç–æ—á–Ω–∏—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω–µ)‚Äî Apple Watch –∏–ª–∏ Airpods</div>
            <div class="task"><input type="file" id="task4-2" accept="image/*,video/*"><button onclick="submitTask('task4-2', 0, '–ó–∞–±—Ä–∞—Ç—å—Å—è –Ω–∞ –≥–æ—Ä—É', 'MacBook')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ó–∞–±—Ä–∞—Ç—å—Å—è –Ω–∞ –≥–æ—Ä—É —Å —Ñ–ª–∞–≥–æ–º ONYX (—É—Ç–æ—á–Ω—è—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω–µ)‚Äî MacBook (–∑–∞ 5000 –º–µ—Ç—Ä–æ–≤ –∏ –±–æ–ª–µ–µ)</div>
            <div class="task"><input type="file" id="task4-3" accept="image/*,video/*"><button onclick="submitTask('task4-3', 0, '–¢–∞—Ç—É ONYX', 'AirPods')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –¢–∞—Ç—É ONYX (—Ä–µ–∞–ª—å–Ω–∞—è –Ω–∞ –≤–∏–¥–Ω–æ–º –º–µ—Å—Ç–µ. –î–∏–∑–∞–π–Ω —É—Ç–æ—á–Ω—è—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω–µ) ‚Äî AirPods</div>
            <div class="task"><input type="file" id="task4-4" accept="image/*,video/*"><button onclick="submitTask('task4-4', 0, '–ü–µ—Ä–µ–∫–ª–µ–π –º–∞—à–∏–Ω—É', '–ø—Ä–∏–∑—ã –Ω–∞ 10 000 ‚ÇΩ')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ü–µ—Ä–µ–∫–ª–µ–π –º–∞—à–∏–Ω—É –≤ —Ü–≤–µ—Ç–∞ –∏ –ª–æ–≥–æ—Ç–∏–ø—ã ONYX –∏ —Å–Ω–∏–º–∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–π —Ä–∏–ª—Å –æ–± —ç—Ç–æ–º –∏ –ø—Ä–æ–¥–µ—Ä–∂–∏ –≤–∏–Ω–∏–ª –ø–æ–ª–≥–æ–¥–∞ (—É—Ç–æ—á–Ω—è—Ç—å –≤ –º–∞–≥–∞–∑–∏–Ω–µ)‚Äî –ø—Ä–∏–∑—ã –Ω–∞ 10 000 ‚ÇΩ</div>
            <div class="task"><input type="file" id="task4-5" accept="image/*,video/*"><button onclick="submitTask('task4-5', 0, '1 000 000 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤', '–ª—é–±–æ–π –ø—Ä–∏–∑ –ø–æ –≤—ã–±–æ—Ä—É')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> 1 000 000 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —Å —Ç–µ—Ö–Ω–∏–∫–æ–π ONYX ‚Äî –ª—é–±–æ–π –ø—Ä–∏–∑ –ø–æ –≤—ã–±–æ—Ä—É</div>
            <button onclick="backToMain()">–ù–∞–∑–∞–¥</button>
        </div>

        <div id="srank-tasks" class="section hidden">
            <h2>üî¥ S-Rank ‚Äî –û—Å–æ–±–µ–Ω–Ω—ã–π</h2>
            <div class="task"><input type="file" id="srank-1" accept="image/*,video/*"><button onclick="submitTask('srank-1', 0, '100 000 000 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤', '5 –ª–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∞–π—Ñ–æ–Ω')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> 100 000 000 –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –Ω–∞ Instagram/tiktok ‚Äì 5 –ª–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∞–π—Ñ–æ–Ω</div>
            <button onclick="backToMain()">–ù–∞–∑–∞–¥</button>
        </div>
    </div>

    <script>
        let points = 0;
        let bonusPoints = 0;
        let userId;
        let referralsCount = 0;
        let maxReferrals = 10;
        const completedTasks = new Set();
        const SERVER_URL = 'https://9fb0995630cd.ngrok-free.app/submit'; // –ó–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π ngrok URL

        document.addEventListener('DOMContentLoaded', () => {
            const tg = window.Telegram.WebApp;
            tg.ready();
            tg.expand();
            userId = tg.initDataUnsafe?.user?.id || `guest_${Math.floor(Math.random() * 1000000)}`;
            document.getElementById('referralLink').textContent = `https://t.me/YourBotName?start=ref_${userId}`; // –ó–∞–º–µ–Ω–∏ YourBotName –Ω–∞ –∏–º—è –±–æ—Ç–∞
            document.getElementById('referralsCount').textContent = referralsCount;
            document.getElementById('points').textContent = points;
            document.getElementById('bonusPoints').textContent = bonusPoints;
        });

        function showLevel(level) {
            document.querySelectorAll('.task-level').forEach(el => el.classList.add('hidden'));
            const tasksDiv = document.getElementById(`${level}-tasks`);
            tasksDiv.classList.remove('hidden');
            if (level === 'level4' || level === 'srank') {
                tasksDiv.querySelectorAll('button').forEach(btn => btn.disabled = false);
            } else if (level !== 'level1' && !allTasksCompleted(`level${parseInt(level.slice(-1)) - 1}`)) {
                tasksDiv.querySelectorAll('button').forEach(btn => btn.disabled = true);
            }
        }

        function backToMain() {
            document.querySelectorAll('.task-level').forEach(el => el.classList.remove('hidden'));
            document.querySelectorAll('.section.hidden').forEach(el => el.classList.add('hidden'));
        }

        function allTasksCompleted(levelPrefix) {
            const tasks = document.querySelectorAll(`#${levelPrefix}-tasks .task button`);
            return Array.from(tasks).every(btn => completedTasks.has(btn.parentElement.querySelector('input').id));
        }

        function isLocked(prevLevel) {
            if (prevLevel && prevLevel !== 'level1' && !allTasksCompleted(prevLevel)) {
                return true;
            }
            return false;
        }

        function submitTask(taskId, pointsValue, taskName, prize = null, isLocked = false) {
            const fileInput = document.getElementById(taskId);
            const file = fileInput.files ? fileInput.files[0] : null;
            const button = document.querySelector(`#${taskId}`).nextElementSibling;
            if (isLocked) {
                button.disabled = true;
                return;
            }
            if (!file) {
                alert('–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª');
                return;
            }
            if (!completedTasks.has(taskId)) {
                completedTasks.add(taskId);
                const formData = new FormData();
                formData.append('userId', userId);
                formData.append('taskName', taskName);
                formData.append('pointsValue', pointsValue);
                formData.append('prize', prize || '');
                formData.append('file', file);

                fetch(SERVER_URL, {
                    method: 'POST',
                    body: formData
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status} - ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.status === 'pending') {
                        alert('–û–∂–∏–¥–∞–π—Ç–µ –æ—Ç–≤–µ—Ç–∞ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞');
                    } else if (data.status === 'error') {
                        alert(data.message || '–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–¥–∞–Ω–∏—è.');
                        completedTasks.delete(taskId); // –†–∞–∑—Ä–µ—à–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø–æ–ø—ã—Ç–∫—É
                    }
                })
                .catch(error => {
                    console.error('Fetch error details:', error);
                    alert(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–∞–π–ª–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞: ${error.message}`);
                    completedTasks.delete(taskId); // –†–∞–∑—Ä–µ—à–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø–æ–ø—ã—Ç–∫—É –ø—Ä–∏ –æ—à–∏–±–∫–µ
                });
            } else {
                alert('–ó–∞–¥–∞–Ω–∏–µ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!');
            }
        }

        function shareReferral() {
            Telegram.WebApp.shareUrl(`https://t.me/YourBotName?start=ref_${userId}`, '–ü—Ä–∏–≥–ª–∞—à–∞—é –≤ ONYX: –í—ã–∑–æ–≤ –ø—Ä–∏–Ω—è—Ç!');
        }

        function buyPrize(prizeName, cost) {
            if (bonusPoints >= cost) {
                bonusPoints -= cost;
                updateBonusPoints();
                gifts.add(prizeName);
                updateGifts();
                alert(`–í—ã –∫—É–ø–∏–ª–∏ "${prizeName}" –∑–∞ ${cost} –±–∞–ª–ª–æ–≤!`);
                // –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É
                fetch(SERVER_URL, {
                    method: 'POST',
                    body: JSON.stringify({ action: 'purchase', userId, prizeName }),
                    headers: { 'Content-Type': 'application/json' }
                });
            } else {
                alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–ª–æ–≤ –¥–ª—è –ø–æ–∫—É–ø–∫–∏!');
            }
        }

        function updateBonusPoints() {
            document.getElementById('bonusPoints').textContent = bonusPoints;
        }
    </script>
</body>
</html>
