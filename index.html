<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONYX: –í—ã–∑–æ–≤ –ø—Ä–∏–Ω—è—Ç</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial, sans-serif; background-color: #fff; color: #2c3e50; margin: 0; padding: 0; }
        .container { max-width: 600px; margin: 20px auto; padding: 20px; }
        .header { text-align: center; background-color: #2c3e50; color: white; padding: 10px; border-radius: 5px; }
        .section { margin: 20px 0; padding: 15px; border: 1px solid #ecf0f1; border-radius: 5px; background-color: #f5f6fa; }
        .task-level h2 { margin-top: 0; }
        .task { margin: 10px 0; }
        .task input[type="file"] { margin-top: 5px; }
        .task button { background-color: #2ecc71; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; }
        .task button:hover { background-color: #27ae60; }
        .balance, .gifts { margin: 10px 0; }
        .leaderboard h3, .balance h3, .gifts h3 { margin-top: 0; }
        .leaderboard ul, .gifts ul { list-style: none; padding: 0; }
        .leaderboard li, .gifts li { padding: 5px 0; }
        #points, .gift-item { font-weight: bold; color: #e67e22; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ONYX: –í—ã–∑–æ–≤ –ø—Ä–∏–Ω—è—Ç</h1>
            <p>–í–∞—à–∏ –±–∞–ª–ª—ã: <span id="points">0</span></p>
        </div>

        <div class="section task-level" id="level1">
            <h2>üü¢ Level 1 ‚Äî –ù–æ–≤–∏—á–æ–∫</h2>
            <div class="task"><input type="file" id="task1-1" accept="image/*,video/*"><button onclick="submitTask('task1-1', 50, '–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ Telegram/Instagram')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ Telegram –∏ Instagram ONYX ‚Äî 50 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task1-2" accept="image/*,video/*"><button onclick="submitTask('task1-2', 100, '–ü–æ–∫—É–ø–∫–∞')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –û—Ñ–æ—Ä–º–∏ –ø–æ–∫—É–ø–∫—É ‚Äî 100 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task1-3" accept="image/*,video/*"><button onclick="submitTask('task1-3', 100, '–û—Ç–∑—ã–≤')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –û—Å—Ç–∞–≤—å –æ—Ç–∑—ã–≤ ‚Äî 100 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task1-4" accept="image/*,video/*"><button onclick="submitTask('task1-4', 150, '–°—Ç–æ—Ä–∏—Å')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –û—Ç–º–µ—Ç—å –≤ —Å—Ç–æ—Ä–∏—Å ‚Äî 150 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task1-5" accept="image/*,video/*"><button onclick="submitTask('task1-5', 70, '–í–∏–∫—Ç–æ—Ä–∏–Ω–∞')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –£—á–∞—Å—Ç–≤—É–π –≤ –≤–∏–∫—Ç–æ—Ä–∏–Ω–µ ‚Äî 70 –±–∞–ª–ª–æ–≤</div>
        </div>

        <div class="section task-level" id="level2">
            <h2>üü° Level 2 ‚Äî –•–∞—Å—Ç–ª–µ—Ä</h2>
            <div class="task"><input type="file" id="task2-1" accept="image/*,video/*"><button onclick="submitTask('task2-1', 300, '–†–µ—Ñ–µ—Ä–∞–ª')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ü—Ä–∏–≤–µ–¥–∏ –¥—Ä—É–≥–∞ ‚Äî 300 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task2-2" accept="image/*,video/*"><button onclick="submitTask('task2-2', 300, '–¢—Ä–µ–π–¥-–∏–Ω')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ü—Ä–∏–Ω–µ—Å–∏ —Å–º–∞—Ä—Ç—Ñ–æ–Ω ‚Äî 300 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task2-3" accept="image/*,video/*"><button onclick="submitTask('task2-3', 400, '–û–±–∑–æ—Ä')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –°–Ω–∏–º–∏ –æ–±–∑–æ—Ä ‚Äî 400 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task2-4" accept="image/*,video/*"><button onclick="submitTask('task2-4', 500, '–†–µ–ø–æ—Ä—Ç–∞–∂')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –°–¥–µ–ª–∞–π —Ä–µ–ø–æ—Ä—Ç–∞–∂ ‚Äî 500 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task2-5" accept="image/*,video/*"><button onclick="submitTask('task2-5', 500, '–°—Ç–∞—Ç—å—è')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ù–∞–ø–∏—à–∏ —Å—Ç–∞—Ç—å—é ‚Äî 500 –±–∞–ª–ª–æ–≤</div>
        </div>

        <div class="section task-level" id="level3">
            <h2>üîµ Level 3 ‚Äî –†–µ–∑–∏–¥–µ–Ω—Ç ONYX</h2>
            <div class="task"><input type="file" id="task3-1" accept="image/*,video/*"><button onclick="submitTask('task3-1', 600, 'Reels')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> Reels —Å —Å—é–∂–µ—Ç–æ–º ‚Äî 600 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task3-2" accept="image/*,video/*"><button onclick="submitTask('task3-2', 800, '5 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> 5 —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ ‚Äî 800 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task3-3" accept="image/*,video/*"><button onclick="submitTask('task3-3', 1000, 'TikTok')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –í–∏—Ä—É—Å–Ω—ã–π TikTok ‚Äî 1000 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task3-4" accept="image/*,video/*"><button onclick="submitTask('task3-4', 1200, '–§–ª–µ—à–º–æ–±')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –£–ª–∏—á–Ω—ã–π —Ñ–ª–µ—à–º–æ–± ‚Äî 1200 –±–∞–ª–ª–æ–≤</div>
            <div class="task"><input type="file" id="task3-5" accept="image/*,video/*"><button onclick="submitTask('task3-5', 1500, '–ö–æ—Å–ø–ª–µ–π')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ö–æ—Å–ø–ª–µ–π-–ø—Ä–æ–¥–∞–≤–µ—Ü ‚Äî 1500 –±–∞–ª–ª–æ–≤</div>
        </div>

        <div class="section task-level" id="level4">
            <h2>üî¥ Level 4 ‚Äî –ë–µ–∑–±–∞—à–µ–Ω–Ω—ã–π</h2>
            <div class="task"><input type="file" id="task4-1" accept="image/*,video/*"><button onclick="submitTask('task4-1', 0, '–ü–∞—Ä–∞—à—é—Ç', 'iPhone 16 Pro')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ü—Ä—ã–∂–æ–∫ —Å –ø–∞—Ä–∞—à—é—Ç–æ–º ‚Äî iPhone 16 Pro</div>
            <div class="task"><input type="file" id="task4-2" accept="image/*,video/*"><button onclick="submitTask('task4-2', 0, '–ö—Ä—ã—à–∞', 'MacBook')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –ö—Ä—ã—à–∞ –¢–¶ ‚Äî MacBook</div>
            <div class="task"><input type="file" id="task4-3" accept="image/*,video/*"><button onclick="submitTask('task4-3', 0, '–¢–∞—Ç—É', 'AirPods + —Ç–µ—Ö–Ω–∏–∫–∞')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –¢–∞—Ç—É ONYX ‚Äî AirPods + —Ç–µ—Ö–Ω–∏–∫–∞</div>
            <div class="task"><input type="file" id="task4-4" accept="image/*,video/*"><button onclick="submitTask('task4-4', 0, '–í–ª–æ–≥', '100 000 ‚ÇΩ')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> –í–ª–æ–≥ ‚Äî 100 000 ‚ÇΩ</div>
            <div class="task"><input type="file" id="task4-5" accept="image/*,video/*"><button onclick="submitTask('task4-5', 0, '1M –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤', '–õ—é–±–æ–π –ø—Ä–∏–∑')">–ü—Ä–∏–ª–æ–∂–∏—Ç—å —Ñ–∞–π–ª</button> 1M –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ ‚Äî –ª—é–±–æ–π –ø—Ä–∏–∑</div>
        </div>

        <div class="section balance">
            <h3>–ë–∞–ª–∞–Ω—Å –±–æ–Ω—É—Å–Ω—ã—Ö —Ä—É–±–ª–µ–π</h3>
            <p>–ë–∞–ª–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ–±–º–µ–Ω—è—Ç—å –Ω–∞ –ø—Ä–∏–∑—ã: <span id="bonusPoints">0</span> ‚ÇΩ</p>
        </div>

        <div class="section gifts">
            <h3>–ú–æ–∏ –ø–æ–¥–∞—Ä–∫–∏</h3>
            <ul id="giftsList"></ul>
        </div>

        <div class="section leaderboard">
            <h3>–¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h3>
            <ul id="leaderboard"></ul>
        </div>
    </div>

    <script>
        let points = 0;
        let bonusPoints = 0;
        let userId;
        const completedTasks = new Set();
        const gifts = new Set();
        const SERVER_URL = 'http://localhost:5001 '; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ URL –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

        document.addEventListener('DOMContentLoaded', () => {
            const initData = Telegram.WebApp.initDataUnsafe;
            userId = initData?.user?.id || Math.floor(Math.random() * 1000000);
            document.getElementById('points').textContent = points;
            document.getElementById('bonusPoints').textContent = bonusPoints;
            updateLeaderboard();
            updateGifts();
        });

        function updatePoints() {
            document.getElementById('points').textContent = points;
        }

        function updateBonusPoints() {
            document.getElementById('bonusPoints').textContent = bonusPoints;
        }

        function updateGifts() {
            const giftsList = document.getElementById('giftsList');
            giftsList.innerHTML = '';
            if (gifts.size === 0) {
                giftsList.innerHTML = '<li>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ–¥–∞—Ä–∫–æ–≤</li>';
            } else {
                gifts.forEach(gift => {
                    const li = document.createElement('li');
                    li.textContent = gift;
                    li.className = 'gift-item';
                    giftsList.appendChild(li);
                });
            }
        }

        function submitTask(taskId, pointsValue, taskName, prize = null) {
            const fileInput = document.getElementById(taskId);
            if (fileInput.files.length > 0 && !completedTasks.has(taskId)) {
                completedTasks.add(taskId);
                const file = fileInput.files[0];
                const formData = new FormData();
                formData.append('userId', userId);
                formData.append('taskName', taskName);
                formData.append('pointsValue', pointsValue);
                formData.append('prize', prize || '');
                formData.append('file', file);

                fetch(SERVER_URL, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'pending') {
                        alert(`–§–∞–π–ª –¥–ª—è "${taskName}" –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –º–æ–¥–µ—Ä–∞—Ç–æ—Ä—É –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É.`);
                    } else if (data.status === 'approved') {
                        points += pointsValue;
                        updatePoints();
                        if (pointsValue > 0) {
                            bonusPoints += pointsValue;
                            updateBonusPoints();
                        }
                        if (prize) {
                            gifts.add(prize);
                            updateGifts();
                            alert(`–ó–∞–¥–∞–Ω–∏–µ "${taskName}" –æ–¥–æ–±—Ä–µ–Ω–æ! –ü—Ä–∏–∑: ${prize}`);
                        } else {
                            alert(`–ó–∞–¥–∞–Ω–∏–µ "${taskName}" –æ–¥–æ–±—Ä–µ–Ω–æ! +${pointsValue} –±–∞–ª–ª–æ–≤`);
                        }
                    } else if (data.status === 'rejected') {
                        alert(`–ó–∞–¥–∞–Ω–∏–µ "${taskName}" –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–æ–º (@ModeratorID: 8107482231).`);
                    }
                })
                .catch(error => alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–∞–π–ª–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.'));
            } else {
                alert('–ó–∞–¥–∞–Ω–∏–µ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –∏–ª–∏ —Ñ–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω!');
            }
        }

        function updateLeaderboard() {
            const leaderboard = document.getElementById('leaderboard');
            leaderboard.innerHTML = '';
            const leaders = [
                { id: 123456, points: 5000 },
                { id: 654321, points: 3000 },
                { id: userId, points: points }
            ].sort((a, b) => b.points - a.points).slice(0, 3);
            leaders.forEach((leader, index) => {
                const li = document.createElement('li');
                li.textContent = `${index + 1}. ID ${leader.id}: ${leader.points} –±–∞–ª–ª–æ–≤`;
                leaderboard.appendChild(li);
            });
        }

        Telegram.WebApp.ready();
        Telegram.WebApp.expand();
        Telegram.WebApp.MainButton.setText('–û–±–Ω–æ–≤–∏—Ç—å');
        Telegram.WebApp.MainButton.onClick(updateLeaderboard);
    </script>
</body>
</html>
